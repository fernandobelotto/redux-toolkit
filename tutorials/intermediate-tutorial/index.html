<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-130598673-3","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Redux Toolkit" href="/redux-toolkit/opensearch.xml"><title data-react-helmet="true">Intermediate Tutorial | Redux Toolkit</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" property="og:image" content="https://fernandobelotto.github.io/redux-toolkit/img/redux-logo-landscape.png"><meta data-react-helmet="true" property="twitter:image" content="https://fernandobelotto.github.io/redux-toolkit/img/redux-logo-landscape.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for Redux Toolkit"><meta data-react-helmet="true" name="twitter:card" content="summary"><meta data-react-helmet="true" property="og:title" content="Intermediate Tutorial | Redux Toolkit"><meta data-react-helmet="true" name="description" content="Tutorial intermedi√°rio: Redux Toolkit em a√ß√£o"><meta data-react-helmet="true" property="og:description" content="Tutorial intermedi√°rio: Redux Toolkit em a√ß√£o"><meta data-react-helmet="true" property="og:url" content="https://fernandobelotto.github.io/redux-toolkit/tutorials/intermediate-tutorial"><link data-react-helmet="true" rel="shortcut icon" href="/redux-toolkit/img/favicon/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://fernandobelotto.github.io/redux-toolkit/tutorials/intermediate-tutorial"><link rel="stylesheet" href="/redux-toolkit/styles.4024d809.css">
<link rel="preload" href="/redux-toolkit/styles.eb99357f.js" as="script">
<link rel="preload" href="/redux-toolkit/runtime~main.68ebf52a.js" as="script">
<link rel="preload" href="/redux-toolkit/main.3d9f7115.js" as="script">
<link rel="preload" href="/redux-toolkit/1.57fadc6f.js" as="script">
<link rel="preload" href="/redux-toolkit/2.2b7db848.js" as="script">
<link rel="preload" href="/redux-toolkit/27.1911eaf1.js" as="script">
<link rel="preload" href="/redux-toolkit/30.fc892cc4.js" as="script">
<link rel="preload" href="/redux-toolkit/f976f453.bed7d5e1.js" as="script">
<link rel="preload" href="/redux-toolkit/17896441.4d650456.js" as="script">
<link rel="preload" href="/redux-toolkit/0fdf4150.821e68e8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/redux-toolkit/"><img class="navbar__logo" src="/redux-toolkit/img/redux.svg" alt="Redux Logo"><strong class="navbar__title">Redux Toolkit</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/redux-toolkit/introduction/quick-start">Come√ßo r√°pido</a><a class="navbar__item navbar__link" href="/redux-toolkit/api/configureStore">API</a><a href="https://github.com/reduxjs/redux-toolkit" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">‚åò</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/redux-toolkit/"><img class="navbar__logo" src="/redux-toolkit/img/redux.svg" alt="Redux Logo"><strong class="navbar__title">Redux Toolkit</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/introduction/quick-start">Come√ßo r√°pido</a></li><li class="menu__list-item"><a class="menu__link" href="/redux-toolkit/api/configureStore">API</a></li><li class="menu__list-item"><a href="https://github.com/reduxjs/redux-toolkit" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introdu√ß√£o</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/introduction/quick-start">In√≠cio R√°pido</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutoriais</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/tutorials/basic-tutorial">Basic Tutorial</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/redux-toolkit/tutorials/intermediate-tutorial">Intermediate Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/tutorials/advanced-tutorial">Advanced Tutorial</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Usando Redux Toolkit</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/usage/usage-guide">Usage Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/redux-toolkit/usage/usage-with-typescript">Usage With TypeScript</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Refer√™ncia de API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Store Setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/configureStore">configureStore</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/getDefaultMiddleware">getDefaultMiddleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/immutabilityMiddleware">Immutability Middleware</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/serializabilityMiddleware">Serializability Middleware</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Reducers and Actions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createReducer">createReducer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createAction">createAction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createSlice">createSlice</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createAsyncThunk">createAsyncThunk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createEntityAdapter">createEntityAdapter</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/createSelector">createSelector</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/matching-utilities">Matching Utilities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/redux-toolkit/api/other-exports">Other Exports</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="tutorial-intermedi√°rio-redux-toolkit-em-a√ß√£o"></a>Tutorial intermedi√°rio: Redux Toolkit em a√ß√£o<a aria-hidden="true" tabindex="-1" class="hash-link" href="#tutorial-intermedi√°rio-redux-toolkit-em-a√ß√£o" title="Direct link to heading">#</a></h1><p>In the <a href="/redux-toolkit/tutorials/basic-tutorial">Basic Tutorial</a>, you saw the main API functions that are included in Redux Toolkit, and some short examples of why and how to use them. You also saw that you can use Redux and RTK from a plain JS script tag in an HTML page, without using React, NPM, Webpack, or any build tools.</p><p>In this tutorial, you&#x27;ll see how to use those APIs in a small React app. Specifically, we&#x27;re going to convert the <a href="https://redux.js.org/introduction/examples#todos" target="_blank" rel="noopener noreferrer">original Redux &quot;todos&quot; example app</a> to use RTK instead.</p><p>This will show several concepts:</p><ul><li>How to convert &quot;plain Redux&quot; code to use RTK</li><li>How to use RTK in a typical React+Redux app</li><li>How some of the more powerful features of RTK can be used to simplify your Redux code</li></ul><p>Also, while this isn&#x27;t specific to RTK, we&#x27;ll look at a couple ways you can improve your React-Redux code as well.</p><p>The complete source code for the converted application from this tutorial is available at <a href="https://github.com/reduxjs/rtk-convert-todos-example" target="_blank" rel="noopener noreferrer">github.com/reduxjs/rtk-convert-todos-example</a>. We&#x27;ll be walking through the conversion process as shown in this repo&#x27;s history. Links to meaningful individual commits will be highlighted in quote blocks, like this:</p><blockquote><ul><li>Commit message here</li></ul></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reviewing-the-redux-todos-example"></a>Reviewing the Redux Todos Example<a aria-hidden="true" tabindex="-1" class="hash-link" href="#reviewing-the-redux-todos-example" title="Direct link to heading">#</a></h2><p>If we inspect <a href="https://github.com/reduxjs/redux/tree/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src" target="_blank" rel="noopener noreferrer">the current &quot;todos&quot; example source code</a>, we can observe a few things:</p><ul><li>The <a href="https://github.com/reduxjs/redux/blob/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/reducers/todos.js" target="_blank" rel="noopener noreferrer"><code>todos</code> reducer function</a> is doing immutable updates &quot;by hand&quot;, by copying nested JS objects and arrays</li><li>The <a href="https://github.com/reduxjs/redux/blob/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/actions/index.js" target="_blank" rel="noopener noreferrer"><code>actions</code> file</a> has hand-written action creator functions, and the action type strings are being duplicated between the actions file and the reducer files</li><li>The code is laid out using a <a href="https://redux.js.org/faq/code-structure#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go" target="_blank" rel="noopener noreferrer">&quot;folder-by-type&quot; structure</a>, with separate files for <code>actions</code> and <code>reducers</code></li><li>The React components are written using a strict version of the <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0" target="_blank" rel="noopener noreferrer">&quot;container/presentational&quot; pattern</a>, where <a href="https://github.com/reduxjs/redux/tree/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/components" target="_blank" rel="noopener noreferrer">the &quot;presentational&quot; components are in one folder</a>, and the <a href="https://github.com/reduxjs/redux/tree/9c9a4d2a1c62c9dbddcbb05488f8bd77d24c81de/examples/todos/src/containers" target="_blank" rel="noopener noreferrer">Redux &quot;container&quot; connection definitions are in a different folder</a></li><li>Some of the code isn&#x27;t following some of the recommended Redux &quot;best practices&quot; patterns. We&#x27;ll look at some specific examples as we go through this tutorial.</li></ul><p>On the one hand, this is a small example app. It&#x27;s meant to illustrate the basics of actually using React and Redux together, and not necessarily be used as &quot;the right way&quot; to do things in a full-scale production application. On the other hand, most people will use patterns they see in docs and examples, and there&#x27;s definitely room for improvement here.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="initial-conversion-steps"></a>Initial Conversion Steps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#initial-conversion-steps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-redux-toolkit-to-the-project"></a>Adding Redux Toolkit to the Project<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-redux-toolkit-to-the-project" title="Direct link to heading">#</a></h3><p>Since the original todos example is in the Redux repo, we start by copying the Redux &quot;todos&quot; source code to a fresh Create-React-App project, and adding Prettier to the project to help make sure the code is formatted consistently. There&#x27;s also a <a href="https://code.visualstudio.com/docs/languages/jsconfig" target="_blank" rel="noopener noreferrer">jsconfig.json</a> file to enable us to use &quot;absolute import paths&quot; that start from the <code>/src</code> folder.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/a8e0a9a9d77b9dcd9e881079e7cca449084ca7b1" target="_blank" rel="noopener noreferrer">Initial commit</a>.</li><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b866e205b9ebece84367f11d2faabc557bd08e23" target="_blank" rel="noopener noreferrer">Add jsconfig.json to support absolute imports</a></li></ul></blockquote><p>In the Basic Tutorial, we just linked to Redux Toolkit as an individual script tag. But, in a typical application, you need to add RTK as a package dependency in your project. This can be done with either the NPM or Yarn package managers:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#778090"># If you&#x27;re using NPM:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">npm</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">install</span><span class="token plain"> @reduxjs/toolkit</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#778090"># Or for Yarn:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token function" style="color:#E6D874">yarn</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">add</span><span class="token plain"> @reduxjs/toolkit</span></div></div></div></div></div><p>Once that&#x27;s complete, you should add and commit the modified <code>package.json</code> file and the &quot;lock file&quot; from your package manager (<code>package-lock.json</code> for NPM, or <code>yarn.lock</code> for Yarn).</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/c3f47aeaecf855561e4db9d452b928f1b8b6c016" target="_blank" rel="noopener noreferrer">Add Redux Toolkit</a></li></ul></blockquote><p>With that done, we can start to work on the code.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="converting-the-store-to-use-configurestore"></a>Converting the Store to Use <code>configureStore</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#converting-the-store-to-use-configurestore" title="Direct link to heading">#</a></h3><p>Just like with the &quot;counter&quot; example, we can replace the plain Redux <code>createStore</code> function with RTK&#x27;s <code>configureStore</code>. This will automatically set up the Redux DevTools Extension for us.</p><p>The changes here are simple. We update <code>src/index.js</code> to import <code>configureStore</code> instead of <code>createStore</code>, and replace the function call. Remember that <code>configureStore</code> takes an options object as a parameter with named fields, so instead of passing <code>rootReducer</code> directly as the first parameter, we pass it as an object field named <code>reducer</code>:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/cdfc15edbd82beda9ef0521aa191574b6cc7695a" target="_blank" rel="noopener noreferrer">Convert store setup to use configureStore</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import React from &quot;react&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { render } from &quot;react-dom&quot;;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { createStore } from &quot;redux&quot;;</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { configureStore } from &quot;@reduxjs/toolkit&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import { Provider } from &quot;react-redux&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import App from &quot;./components/App&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import rootReducer from &quot;./reducers&quot;;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- const store = createStore(rootReducer);</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ const store = configureStore({</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+   reducer: rootReducer,</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+});</span></div></div></div></div></div><p><strong>Note that we&#x27;re still using the same root reducer function that&#x27;s already in the application, and a Redux store is still being created. All that&#x27;s changed is the store is automatically set up with tools to aid you in development.</strong></p><p>If you have <a href="https://github.com/zalmoxisus/redux-devtools-extension" target="_blank" rel="noopener noreferrer">the Redux DevTools browser extension</a> installed, you should now be able to see the current state if you start the application in development mode and open the DevTools Extension. It should look like this:</p><p><img alt="Redux DevTools Extension screenshot showing initial state" src="/redux-toolkit/assets/images/int-tut-01-redux-devtools-7d5791a49c7eecdb47a3cbf97f436222.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-the-todos-slice"></a>Creating the Todos Slice<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-the-todos-slice" title="Direct link to heading">#</a></h2><p>The first big step for rewriting the app is to convert the todos logic into a new &quot;slice&quot;.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="understanding-slices"></a>Understanding Slices<a aria-hidden="true" tabindex="-1" class="hash-link" href="#understanding-slices" title="Direct link to heading">#</a></h3><p>Right now, the todos code is split into two parts. The reducer logic is in <code>reducers/todos.js</code>, while the action creators are in <code>actions/index.js</code>. In a larger app, we might even see the action type constants in their own file, like <code>constants/todos.js</code>, so they can be reused in both places.</p><p>We <em>could</em> replace those using RTK&#x27;s <a href="/redux-toolkit/api/createReducer"><code>createReducer</code></a> and <a href="/redux-toolkit/api/createAction"><code>createAction</code></a> functions. However, the RTK <a href="/redux-toolkit/api/createSlice"><code>createSlice</code> function</a> allows us to consolidate that logic in one place. It uses <code>createReducer</code> and <code>createAction</code> internally, so <strong>in most apps, you won&#x27;t need to use them yourself - <code>createSlice</code> is all you need</strong>.</p><p>You may be wondering, &quot;what is a &#x27;slice&#x27;, anyway?&quot;. A normal Redux application has a JS object at the top of its state tree, and that object is the result of calling the Redux <a href="https://redux.js.org/api/combinereducers" target="_blank" rel="noopener noreferrer"><code>combineReducers</code> function</a> to join multiple reducer functions into one larger &quot;root reducer&quot;. <strong>We refer to one key/value section of that object as a &quot;slice&quot;, and we use the term <a href="https://redux.js.org/recipes/structuring-reducers/splitting-reducer-logic" target="_blank" rel="noopener noreferrer">&quot;slice reducer&quot;</a> to describe the reducer function responsible for updating that slice of the state</strong>.</p><p>In this app, the root reducer looks like:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> todos </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./todos&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> visibilityFilter </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;./visibilityFilter&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">combineReducers</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  todos</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>So, the combined state looks like <code>{todos: [], visibilityFilter: &quot;SHOW_ALL&quot;}</code>. <code>state.todos</code> is a &quot;slice&quot;, and the <code>todos</code> reducer function is a &quot;slice reducer&quot;.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="examining-the-original-todos-reducer"></a>Examining the Original Todos Reducer<a aria-hidden="true" tabindex="-1" class="hash-link" href="#examining-the-original-todos-reducer" title="Direct link to heading">#</a></h3><p>The original todos reducer logic looks like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">todos</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:#F8F8F2">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#F8F8F2">[</span><span class="token parameter punctuation" style="color:#F8F8F2">]</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">case</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">state</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">case</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;TOGGLE_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">map</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">todo</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> </span><span class="token spread operator" style="color:#F8F8F2">...</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> todo</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword module" style="color:#F92672">default</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> state</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> todos</span></div></div></div></div></div><p>We can see that it handles three cases:</p><ul><li>It adds a new todo by copying the existing <code>state</code> array and adding a new todo entry at the end</li><li>It handles toggling a todo entry by copying the existing array using <code>state.map()</code>, copies and replaces the todo object that needs to be updated, and leaves all other todo entries alone.</li><li>It responds to all other actions by returning the existing state (effectively saying &quot;I don&#x27;t care about that action&quot;).</li></ul><p>It also initializes the state with a default value of <code>[]</code>, and does a default export of the reducer function.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="writing-the-slice-reducer"></a>Writing the Slice Reducer<a aria-hidden="true" tabindex="-1" class="hash-link" href="#writing-the-slice-reducer" title="Direct link to heading">#</a></h3><p>We can do the same work with <code>createSlice</code>, but we can do it in a simpler way.</p><p>We&#x27;ll start by adding a new file called <code>/features/todos/todosSlice.js</code>. Note that while it doesn&#x27;t matter how you actually structure your folders and files, we&#x27;ve found that <a href="https://redux.js.org/faq/code-structure#what-should-my-file-structure-look-like-how-should-i-group-my-action-creators-and-reducers-in-my-project-where-should-my-selectors-go" target="_blank" rel="noopener noreferrer">a &quot;feature folder&quot; approach</a> usually works better for most applications. The file name is also entirely up to you, but a convention of <code>someFeatureSlice.js</code> is reasonable to use.</p><p>In this file, we&#x27;ll add the following logic:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/48ce059dbb0fce1b961631821534fbcb766d3471" target="_blank" rel="noopener noreferrer">Add an initial todos slice</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todosSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;todos&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">find</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">todo</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">id</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">===</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todo</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">completed</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> toggleTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> todosSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> todosSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="createslice-options"></a><code>createSlice</code> Options<a aria-hidden="true" tabindex="-1" class="hash-link" href="#createslice-options" title="Direct link to heading">#</a></h4><p>Let&#x27;s break down what this does:</p><ul><li><code>createSlice</code> takes an options object as its argument, with these options:<ul><li><code>name</code>: a string that is used as the prefix for generated action types</li><li><code>initialState</code>: the initial state value for the reducer</li><li><code>reducers</code>: an object, where the keys will become action type strings, and the functions are reducers that will be run when that action type is dispatched. (These are sometimes referred to as <a href="https://redux.js.org/recipes/structuring-reducers/splitting-reducer-logic" target="_blank" rel="noopener noreferrer">&quot;case reducers&quot;</a>, because they&#x27;re similar to a <code>case</code> in a <code>switch</code> statement)</li></ul></li></ul><p>So, the <code>addTodo</code> case reducer function will be run when an action with the type <code>&quot;todos/addTodo&quot;</code> is dispatched.</p><p>There&#x27;s no <code>default</code> handler here. The reducer generated by <code>createSlice</code> will automatically handle all other action types by returning the current state, so we don&#x27;t have to list that ourselves.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mutable-update-logic"></a>&quot;Mutable&quot; Update Logic<a aria-hidden="true" tabindex="-1" class="hash-link" href="#mutable-update-logic" title="Direct link to heading">#</a></h4><p>Notice that the <code>addTodo</code> reducer is calling <code>state.push()</code>. Normally, this is bad, because <a href="https://doesitmutate.xyz/#push" target="_blank" rel="noopener noreferrer">the <code>array.push()</code> function mutates the existing array</a>, and <strong><a href="https://redux.js.org/basics/reducers#handling-actions" target="_blank" rel="noopener noreferrer">Redux reducers must <em>never</em> mutate state!</a></strong>.</p><p>However, <code>createSlice</code> and <code>createReducer</code> wrap your function with <a href="https://github.com/immerjs/immer" target="_blank" rel="noopener noreferrer"><code>produce</code> from the Immer library</a>. <strong>This means you can write code that &quot;mutates&quot; the state inside the reducer, and Immer will safely return a correct immutably updated result.</strong></p><p>Similarly, <code>toggleTodo</code> doesn&#x27;t map over the array or copy the matching todo object. Instead, it just finds the matching todo object, and then mutates it by assigning <code>todo.completed = !todo.completed</code>. Again, Immer knows this object was updated, and makes copies of both the todo object and the containing array.</p><p>Normal immutable update logic tends to obscure what you&#x27;re actually trying to do because of all of the extra copying that has to happen. Here, the intent should be much more clear: we&#x27;re adding an item to the end of an array, and we&#x27;re modifying a field in a todo entry.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="exporting-the-slice-functions"></a>Exporting the Slice Functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#exporting-the-slice-functions" title="Direct link to heading">#</a></h4><p><code>createSlice</code> returns an object that looks like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function-variable function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  actions</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos/addTodo&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&quot;todos/toggleTodo&quot;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  caseReducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function-variable function" style="color:#E6D874">toggleTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> newState</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p><strong>Notice that it auto-generated the appropriate action creator functions <em>and</em> action types for each of our reducers - we don&#x27;t have to write those by hand!</strong></p><p>We&#x27;ll need to use the action creators and the reducer in other files, so at a minimum we would need to export the slice object. However, we can use a Redux community code convention called <a href="https://github.com/erikras/ducks-modular-redux" target="_blank" rel="noopener noreferrer">the &quot;ducks&quot; pattern</a>. Simply put, <strong>it suggests that you should put all your action creators and reducers in one file, do named exports of the action creators, and a default export of the reducer function</strong>.</p><p>Thanks to <code>createSlice</code>, we already have our action creators and the reducer right here in one file. All we have to do is export them separately, and our todos slice file now matches the common &quot;ducks&quot; pattern.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="working-with-action-payloads"></a>Working with Action Payloads<a aria-hidden="true" tabindex="-1" class="hash-link" href="#working-with-action-payloads" title="Direct link to heading">#</a></h4><p>Speaking of the action creators, let&#x27;s go back and re-examine the reducer logic for a minute.</p><p>By default, the action creators from the RTK <code>createAction</code> function only accept one argument. That argument, whatever it is, is put into the action object as a field called <code>payload</code>.</p><p>There&#x27;s nothing special about the field <code>action.payload</code> by itself. Redux doesn&#x27;t know or care about that name. But, like &quot;ducks&quot;, the name <code>payload</code> comes from another Redux community convention called <a href="https://github.com/redux-utilities/flux-standard-action" target="_blank" rel="noopener noreferrer">&quot;Flux Standard Actions&quot;</a>.</p><p>Actions usually need to include some extra data along with the <code>type</code> field. The original Redux code for <code>addTodo</code> has an action object that looks like <code>{type, id, text}</code>. <strong>The FSA convention suggests that rather than having data fields with random names directly in the action object, you should always put your data inside a field named <code>payload</code></strong>.</p><p>It&#x27;s up to the reducer to establish what it thinks <code>payload</code> should be for each action type, and whatever code dispatches the action needs to pass in values that match that expectation. If only one value is needed, you could potentially use that as the whole <code>payload</code> value directly. More commonly, you&#x27;d need to pass in multiple values, in which case <code>payload</code> should be an object containing those values.</p><p>In our todos slice, <code>addTodo</code> needs two fields, <code>id</code> and <code>text</code>, so we put those into an object as <code>payload</code>. For <code>toggleTodo</code>, the only value we need is the <code>id</code> of the todo being changed. We could have made that the <code>payload</code>, but I prefer always having <code>payload</code> be an object, so I made it <code>action.payload.id</code> instead.</p><p>(As a sneak peek: there <em>is</em> a way to customize how action object payloads are created. We&#x27;ll look at that later in this tutorial, or you can look through <a href="/redux-toolkit/api/createAction">the <code>createAction</code> API docs</a> for an explanation.)</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="updating-the-todos-tests"></a>Updating the Todos Tests<a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-todos-tests" title="Direct link to heading">#</a></h3><p>The original todos reducer has a tests file with it. We can port those over to work with our todos slice, and verify that they both work the same way.</p><p>The first step is to copy <code>reducers/todos.spec.js</code> over to <code>features/todos/todosSlice.spec.js</code>, and change the import path to read the reducer from the slice file.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b603312ddf55899e8a75522d407c40474948ae0b" target="_blank" rel="noopener noreferrer">Copy tests to todos slice</a></li></ul></blockquote><p>Once that is done, we need to update the tests to match how RTK works.</p><p>The first issue is that the test file hardcodes action types like <code>&#x27;ADD_TODO&#x27;</code>. RTK&#x27;s action types look like <code>&#x27;todos/addTodo&#x27;</code>. We can reference that by also importing the action creators from the todos slice, and replacing the original type constants in the test with <code>addTodo.type</code>.</p><p>The other problem is that the action objects in the tests look like <code>{type, id, text}</code>, whereas RTK always puts those extra values inside <code>action.payload</code>. So, we need to modify the test actions to match that.</p><p>(We really <em>could</em> just replace all the inline action objects in the test with calls like <code>addTodo({id : 0, text: &quot;Buy milk&quot;})</code>, but this is a simpler set of changes to show for now.)</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/39dbbf37bd4c559db956c8291bbd0bf1135546bb" target="_blank" rel="noopener noreferrer">Port the todos tests to work with the todos slice</a></li></ul></blockquote><p>An example of the changes would be:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// Change the imports to get the action creators</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import todos from &#x27;./todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import todos, { addTodo, toggleTodo } from &#x27;./todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// later, in a test:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  it(&#x27;should handle ADD_TODO&#x27;, () =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    expect(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">      todos([], {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">-       type: &#x27;ADD_TODO&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-       text: &#x27;Run the tests&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-       id: 0</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+       type: addTodo.type,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+       payload: {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+         text: &#x27;Run the tests&#x27;,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+         id: 0</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+       }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">      })</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    ).toEqual([</span></div></div></div></div></div><p>After those changes, all the tests in <code>todosSlice.spec.js</code> should pass, proving that our new RTK slice reducer works exactly the same as the original hand-written reducer!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="implementing-todo-ids"></a>Implementing Todo IDs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#implementing-todo-ids" title="Direct link to heading">#</a></h3><p>In the original code, each newly added todo gets an ID value from an incrementing number:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">addTodo</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">text</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  type</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  text</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>Right now, our todos slice doesn&#x27;t do that, because the <code>addTodo</code> action creator is automatically generated for us.</p><p>We <em>could</em> add that behavior for requiring that whatever code dispatches the add todo should have to pass in a new ID, like <code>addTodo({id: 1, text: &quot;Buy milk&quot;})</code>, but that would be annoying. Why should the caller have to track that value? Also, what if there are multiple parts of the app that would need to dispatch that action? It would be better to encapsulate that logic in the action creator.</p><p>RTK allows you to customize how the <code>payload</code> field is created in your action objects. If you are using <code>createAction</code> by itself, you can pass a &quot;prepare callback&quot; as the second argument. Here&#x27;s what this would look like:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/0c9e3b721c209d368d23a70cf8faca8f308ff8df" target="_blank" rel="noopener noreferrer">Implement addTodo ID generation</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> addTodo </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createAction</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token parameter">text</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    payload</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p><strong>Note that the &quot;prepare callback&quot; <em>must</em> return an object with a field called <code>payload</code> inside!</strong> Otherwise, the action&#x27;s payload will be undefined. It <em>may</em> also include a field called <code>meta</code>, which can be used to include extra additional metadata related to the action.</p><p>If you&#x27;re using <code>createSlice</code>, it automatically calls <code>createAction</code> for you. If you need to customize the payload there, you can do so by passing an object containing <code>reducer</code> and <code>prepare</code> functions to the <code>reducers</code> object, instead of just the reducer function by itself:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#F92672">let</span><span class="token plain"> nextTodoId </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> todosSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;todos&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    addTodo</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">reducer</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        state</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">push</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> completed</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#AE81FF">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token function" style="color:#E6D874">prepare</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">text</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> payload</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> nextTodoId</span><span class="token operator" style="color:#F8F8F2">++</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span></div></div></div></div></div><p>We can add an additional test that confirms this works:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#E6D874">describe</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;addTodo&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token function" style="color:#E6D874">it</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;should generate incrementing todo IDs&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> action1 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;a&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> action2 </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;b&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">expect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action1</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toEqual</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">0</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;a&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">expect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">action2</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">toEqual</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token number" style="color:#AE81FF">1</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> text</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;b&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-the-new-todos-slice"></a>Using the New Todos Slice<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-new-todos-slice" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="updating-the-root-reducer"></a>Updating the Root Reducer<a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-root-reducer" title="Direct link to heading">#</a></h3><p>We have a shiny new todos reducer function, but it isn&#x27;t hooked up to anything yet.</p><p>The first step is to go update our root reducer to use the reducer from the todos slice instead of the original reducer. We just need to change the import statement in <code>reducers/index.js</code>:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/7b6e005377c856d7415e328387188260330ebae4" target="_blank" rel="noopener noreferrer">Use the todos slice reducer</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { combineReducers } from &#x27;redux&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import todos from &#x27;./todos&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import todosReducer from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import visibilityFilter from &#x27;./visibilityFilter&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default combineReducers({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- todos,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ todos: todosReducer,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">  visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token plain">})</span></div></div></div></div></div><p>While we could have kept the imported function named as <code>todos</code> so that we can use the object literal shorthand with <code>combineReducers</code>, it&#x27;s a little more clear if we name the imported function <code>todosReducer</code> and define the field as <code>todos: todosReducer</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="updating-the-add-todo-component"></a>Updating the Add Todo Component<a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-add-todo-component" title="Direct link to heading">#</a></h3><p>If we reload the app, we should still see that <code>state.todos</code> is an empty array. But, if we click on &quot;Add Todo&quot;, nothing will happen. We&#x27;re still dispatching actions whose type is <code>&#x27;ADD_TODO&#x27;</code>, while our todos slice is looking for an action type of <code>&#x27;todos/addTodo&#x27;</code>. We need to import the correct action creator and use it in the <code>AddTodo.js</code> file.</p><p>While we&#x27;re at it, there are a couple of other problems with how the <code>AddTodo</code> component is written. First, it&#x27;s currently using a React &quot;callback ref&quot; to read the current text value from the input when you click &quot;Add Todo&quot;. This works, but the standard &quot;React way&quot; to handle form fields is with the &quot;controlled inputs&quot; pattern, where the current field value is stored in the component&#x27;s state.</p><p>Second, the connected component is getting <code>dispatch</code> as a prop. Again, this works, but the normal way to use connect is to <a href="https://react-redux.js.org/using-react-redux/connect-mapdispatch" target="_blank" rel="noopener noreferrer">pass action creator functions to <code>connect</code></a>, and then dispatch the actions by calling the functions that were passed in as props.</p><p>Since we&#x27;ve got this component open, we can fix those issues too. Here&#x27;s what the final version looks like:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/d7082409ebaa113b74f6989bf70ee09600f37d0b" target="_blank" rel="noopener noreferrer">Update AddTodo to dispatch the new action type</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> useState </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> connect </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;react-redux&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;features/todos/todosSlice&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> mapDispatch </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> addTodo </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#E6D874">AddTodo</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter punctuation" style="color:#F8F8F2">{</span><span class="token parameter"> addTodo </span><span class="token parameter punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">[</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> setTodoText</span><span class="token punctuation" style="color:#F8F8F2">]</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">useState</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#E6D874">onChange</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">setTodoText</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">target</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">form</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        onSubmit</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token parameter">e</span><span class="token plain"> </span><span class="token arrow operator" style="color:#F8F8F2">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          e</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">preventDefault</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token keyword" style="color:#F92672">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token operator" style="color:#F8F8F2">!</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token method function property-access" style="color:#E6D874">trim</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">addTodo</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">          </span><span class="token function" style="color:#E6D874">setTodoText</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token string" style="color:#a6e22e">&#x27;&#x27;</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">input value</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">todoText</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> onChange</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain">onChange</span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">/</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token plain">button type</span><span class="token operator" style="color:#F8F8F2">=</span><span class="token string" style="color:#a6e22e">&quot;submit&quot;</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token maybe-class-name">Add</span><span class="token plain"> </span><span class="token maybe-class-name">Todo</span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">button</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">form</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token operator" style="color:#F8F8F2">&lt;</span><span class="token operator" style="color:#F8F8F2">/</span><span class="token plain">div</span><span class="token operator" style="color:#F8F8F2">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">connect</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token keyword null nil" style="color:#F92672">null</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"> mapDispatch</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token maybe-class-name">AddTodo</span><span class="token punctuation" style="color:#F8F8F2">)</span></div></div></div></div></div><p>We start by importing the correct <code>addTodo</code> action creator from our todos slice.</p><p>The input is now being handled as a standard &quot;controlled input&quot;, with the text value being stored in the component&#x27;s state. We can use that state text value in the form&#x27;s submit handler.</p><p>Finally, we use the <a href="https://react-redux.js.org/using-react-redux/connect-mapdispatch#defining-mapdispatchtoprops-as-an-object" target="_blank" rel="noopener noreferrer">&quot;object shorthand&quot; form of <code>mapDispatch</code></a> to simplify passing the action creators to <code>connect</code>. The &quot;bound&quot; version of <code>addTodo</code> is passed in to the component as a prop, and it will dispatch the action as soon as we call it.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="updating-the-todo-list"></a>Updating the Todo List<a aria-hidden="true" tabindex="-1" class="hash-link" href="#updating-the-todo-list" title="Direct link to heading">#</a></h3><p>The <code>TodoList</code> and <code>VisibleTodoList</code> components have similar issues: they&#x27;re using the older <code>toggleTodo</code> action creator, and the <code>connect</code> setup isn&#x27;t using the &quot;object shorthand&quot; form of <code>mapDispatch</code>. We can fix both of those.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b47b2124d6a28386b7461bccb9216682a81edb3e" target="_blank" rel="noopener noreferrer">Update TodoList to dispatch the new toggle action type</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// VisibleTodoList.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { toggleTodo } from &#x27;../actions&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { toggleTodo } from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const mapDispatchToProps = dispatch =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">- toggleTodo: id =&gt; dispatch(toggleTodo(id))</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const mapDispatchToProps = { toggleTodo }</span></div></div></div></div></div><p>And with that, we should now be able to add and toggle todos again, but using our new todos slice!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="creating-and-using-the-filters-slice"></a>Creating and Using the Filters Slice<a aria-hidden="true" tabindex="-1" class="hash-link" href="#creating-and-using-the-filters-slice" title="Direct link to heading">#</a></h2><p>Now that we&#x27;ve created the todos slice and hooked it up to the UI, we can do the same for the filter selection logic as well.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="writing-the-filters-slice"></a>Writing the Filters Slice<a aria-hidden="true" tabindex="-1" class="hash-link" href="#writing-the-filters-slice" title="Direct link to heading">#</a></h3><p>The filter logic is really simple. We have one action, which sets the current filter value by returning what&#x27;s in the action. Here&#x27;s the whole slice:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/b77f4155e3b45bce24d0d0ef6e2f7b0c3bd11ee1" target="_blank" rel="noopener noreferrer">Add the filters slice</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-js codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token keyword module" style="color:#F92672">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> createSlice </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">from</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;@reduxjs/toolkit&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token maybe-class-name">VisibilityFilters</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_ALL</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_ALL&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_COMPLETED</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_COMPLETED&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token constant" style="color:#F92672">SHOW_ACTIVE</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;SHOW_ACTIVE&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> filtersSlice </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> </span><span class="token function" style="color:#E6D874">createSlice</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  name</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token string" style="color:#a6e22e">&#x27;visibilityFilters&#x27;</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  initialState</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token maybe-class-name">VisibilityFilters</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token constant" style="color:#F92672">SHOW_ALL</span><span class="token punctuation" style="color:#F8F8F2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  reducers</span><span class="token punctuation" style="color:#F8F8F2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token function" style="color:#E6D874">setVisibilityFilter</span><span class="token punctuation" style="color:#F8F8F2">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#F8F8F2">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token keyword" style="color:#F92672">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">payload</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token punctuation" style="color:#F8F8F2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword" style="color:#F92672">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#F8F8F2">{</span><span class="token plain"> setVisibilityFilter </span><span class="token punctuation" style="color:#F8F8F2">}</span><span class="token plain"> </span><span class="token operator" style="color:#F8F8F2">=</span><span class="token plain"> filtersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">actions</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword module" style="color:#F92672">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#F92672">default</span><span class="token plain"> filtersSlice</span><span class="token punctuation" style="color:#F8F8F2">.</span><span class="token property-access">reducer</span></div></div></div></div></div><p>We&#x27;ve copied over the <code>VisibilityFilters</code> enum object that was originally in <code>actions/index.js</code>. The slice code just creates the one reducer, we export the action creator and reducer, and we&#x27;re done.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-the-filters-slice"></a>Using the Filters Slice<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-filters-slice" title="Direct link to heading">#</a></h3><p>As with the todos reducer, we need to import and add the visibility reducer to our root reducer:</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/623c47b1987914a1d90142824892686ec76c20a1" target="_blank" rel="noopener noreferrer">Use the filters slice reducer</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import todosReducer from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import visibilityFilter from &#x27;./visibilityFilter&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import visibilityFilterReducer from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default combineReducers({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  todos: todosReducer,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">- visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ visibilityFilter: visibilityFilterReducer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">})</span></div></div></div></div></div><p>From there, we need to dispatch the <code>setVisibilityFilter</code> action when the user clicks on the buttons. First, for consistency, we should update <code>VisibleTodoList.js</code> and <code>Footer.js</code> to use the <code>VisibilityFilter</code> enum that&#x27;s exported from the filter slice file, instead of the one from the actions file.</p><p>From there, the link components will take just a bit more work. <code>FilterLink</code> is currently creating new functions that capture the current value of <code>ownProps.filter</code>, so that <code>Link</code> is just getting a function called <code>onClick</code>. While that&#x27;s a valid way to do it, for consistency we&#x27;d like to continue using the object shorthand form of <code>mapDispatch</code>, and modify <code>Link</code> to pass the filter value in when it dispatches the action.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/776b39088384513ff68af41039fe5fc5188fe8fb" target="_blank" rel="noopener noreferrer">Use the new filters action in the UI</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">// FilterLink.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-import { setVisibilityFilter } from &#x27;../actions&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { setVisibilityFilter } from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const mapDispatchToProps = (dispatch, ownProps) =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">- onClick: () =&gt; dispatch(setVisibilityFilter(ownProps.filter))</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const mapDispatchToProps = { setVisibilityFilter }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">// Link.js</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import PropTypes from &#x27;prop-types&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const Link = ({ active, children, onClick }) =&gt; (</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const Link = ({ active, children, setVisibilityFilter, filter }) =&gt; (</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">  &lt;button</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">-    onClick={onClick}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+    onClick={() =&gt; setVisibilityFilter(filter)}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token unchanged">    disabled={active}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    style={{</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">      marginLeft: &#x27;4px&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    }}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  &gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">    {children}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  &lt;/button&gt;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token plain">)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">Link.propTypes = {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token unchanged">  active: PropTypes.bool.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged">  children: PropTypes.node.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#F92672">- onClick: PropTypes.func.isRequired</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ setVisibilityFilter: PropTypes.func.isRequired,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+ filter: PropTypes.string.isRequired</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export default Link</span></div></div></div></div></div><p>Again, note that most of this doesn&#x27;t have to do with RTK specifically, but it&#x27;s good to try to consistently use some of the recommended best practices in this example code.</p><p>With that done, we should be able to add a couple todos, toggle the state of some of them, and then switch the filters to change the display list.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="optimizing-todo-filtering"></a>Optimizing Todo Filtering<a aria-hidden="true" tabindex="-1" class="hash-link" href="#optimizing-todo-filtering" title="Direct link to heading">#</a></h2><p>The <code>VisibleTodoList</code> component currently uses a function called <code>getVisibleTodos</code> to do the work of filtering the todos array for display. This is a &quot;selector function&quot;, as described in the Redux docs page on <a href="https://redux.js.org/recipes/computing-derived-data" target="_blank" rel="noopener noreferrer">Computing Derived Data</a>. It encapsulates the process of reading values from the Redux store and extracting part or all of those values for use.</p><p>However, the code as currently written has a problem. If the filter is set to <code>SHOW_COMPLETED</code> or <code>SHOW_ACTIVE</code>, it will <em>always</em> return a new array <em>every</em> time it is called. Since it&#x27;s being used in a <code>mapState</code> function, that means it will return a new array reference when <em>any</em> action is dispatched.</p><p>In this tiny todo example app, that isn&#x27;t a problem. The only actions we have involve altering the todos list or filtering it, anyway. But, in a real app, many other actions will be dispatched. Imagine if this todo app had a counter in it, and <code>&quot;INCREMENT&quot;</code> was dispatched while the list is filtered. We would create a new list, and the <code>TodoList</code> would have to re-render even though nothing changed.</p><p>While this isn&#x27;t a real performance issue now, it&#x27;s worth showing how we can improve the behavior.</p><p>Redux apps commonly use a library called <a href="https://github.com/reduxjs/reselect" target="_blank" rel="noopener noreferrer">Reselect</a>, which has a <code>createSelector</code> function that lets you define &quot;memoized&quot; selector functions. These memoized selectors only recalculate values if the inputs have actually changed.</p><p>RTK re-exports the <code>createSelector</code> function from Reselect, so we can import that and use it in <code>VisibleTodoList</code>.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/4fc943b7111381974f20f74750a114b5e52ce1b2" target="_blank" rel="noopener noreferrer">Convert visible todos to a memoized selector</a></li></ul></blockquote><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#272822"><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { connect } from &#x27;react-redux&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+import { createSelector } from &#x27;@reduxjs/toolkit&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">import { toggleTodo } from &#x27;features/todos/todosSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import TodoList from &#x27;../components/TodoList&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">import { VisibilityFilters } from &#x27;features/filters/filtersSlice&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">-const getVisibleTodos = (todos, filter) =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-  switch (filter) {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_ALL:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_COMPLETED:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos.filter(t =&gt; t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    case VisibilityFilters.SHOW_ACTIVE:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      return todos.filter(t =&gt; !t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-    default:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-      throw new Error(&#x27;Unknown filter: &#x27; + filter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672">-}</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectTodos = state =&gt; state.todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectFilter = state =&gt; state.visibilityFilter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+const selectVisibleTodos = createSelector(</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  [selectTodos, selectFilter],</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  (todos, filter) =&gt; {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+    switch (filter) {</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_ALL:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_COMPLETED:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos.filter(t =&gt; t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      case VisibilityFilters.SHOW_ACTIVE:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        return todos.filter(t =&gt; !t.completed)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+      default:</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+        throw new Error(&#x27;Unknown filter: &#x27; + filter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+    }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+  }</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e">+)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">const mapStateToProps = state =&gt; ({</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#F92672">- todos: getVisibleTodos(state.todos, state.visibilityFilter)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token deleted-sign deleted" style="color:#F92672"></span><span class="token inserted-sign inserted" style="color:#a6e22e">+ todos: selectVisibleTodos(state)</span></div><div class="token-line" style="color:#f8f8f2"><span class="token inserted-sign inserted" style="color:#a6e22e"></span><span class="token plain">})</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">const mapDispatchToProps = { toggleTodo }</span></div></div></div></div></div><p>First, we import <code>createSelector</code> from RTK, and define a couple one-line selector functions that grab the <code>todos</code> and <code>visibilityFilter</code> fields from their <code>state</code> argument.</p><p>We then call <code>createSelector</code>, and pass those two small selector functions in the &quot;input selectors&quot; array. <code>createSelector</code> will call those, take the return values, and pass those to the &quot;output selector&quot; we&#x27;ve defined, which can then do the filtering and return the final result.</p><p>There&#x27;s a couple small changes in how this is defined and used. While you can give selector functions any name you want, <code>selectX</code> is a more common naming convention than <code>getX</code>. Also, because the input selectors take care of reading the necessary values, we can just call <code>selectVisibleTodos(state)</code>, with <code>state</code> as the only argument.</p><p>If we re-run the app, the filtering logic <em>should</em> work exactly the same as before from what you can see in the UI.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="cleanup"></a>Cleanup<a aria-hidden="true" tabindex="-1" class="hash-link" href="#cleanup" title="Direct link to heading">#</a></h2><p>That&#x27;s the end of the actual conversion work. We now have a bunch of action and reducer files that are no longer being used, so we should delete those to clean up the project.</p><p>We can safely remove <code>actions/index.js</code>, <code>reducers/todos.js</code>, <code>reducers/visibilityFilter.js</code>, and the associated test files.</p><p>We can also try completely switching from the &quot;folder-by-type&quot; structure to a &quot;feature folder&quot; structure, by moving all of the component files into the matching feature folders.</p><blockquote><ul><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/fbc0b965949e082748b8613b734612226ffe9e94" target="_blank" rel="noopener noreferrer">Remove unused action and reducer files</a></li><li><a href="https://github.com/reduxjs/rtk-convert-todos-example/commit/138cc162b1cc9c64ab67fae0a1171d07940414e6" target="_blank" rel="noopener noreferrer">Consolidate components into feature folders</a></li></ul></blockquote><p>If we do that, the final source code structure looks like this:</p><ul><li><code>/src</code><ul><li><code>/components</code><ul><li><code>App.js</code></li></ul></li><li><code>/features</code><ul><li><code>/filters</code><ul><li><code>FilterLink.js</code></li><li><code>filtersSlice.js</code></li><li><code>Footer.js</code></li><li><code>Link.js</code></li></ul></li><li><code>/todos</code><ul><li><code>AddTodo.js</code></li><li><code>Todo.js</code></li><li><code>TodoList.js</code></li><li><code>todosSlice.js</code></li><li><code>todosSlice.spec.js</code></li><li><code>VisibleTodoList.js</code></li></ul></li></ul></li><li><code>/reducers</code><ul><li><code>index.js</code></li></ul></li><li><code>index.js</code></li></ul></li></ul><p>Everyone has different preferences on what makes a &quot;maintainable&quot; folder structure, but overall that result looks pretty consistent and easy to follow.</p><p>Now, let&#x27;s see the final version of the code in action!</p><iframe src="https://codesandbox.io/embed/rtk-convert-todos-example-uqqy3?fontsize=14&amp;hidenavigation=1&amp;module=%2Fsrc%2Ffeatures%2Ftodos%2FtodosSlice.js&amp;theme=dark&amp;view=editor" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="rtk-convert-todos-example" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="summary"></a>Summary<a aria-hidden="true" tabindex="-1" class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>In this tutorial, you saw:</p><ul><li>How to use RTK in a typical React application, including adding the package, writing &quot;slice&quot; files, and dispatching actions from React components</li><li>How to use &quot;mutable&quot; reducers, prepare action payloads, and write selector functions</li><li>Some techniques for simplifying React-Redux code, like using the &quot;object shorthand&quot; form of <code>mapDispatch</code></li><li>Examples of using a &quot;feature folder&quot; structure for organizing your code.</li></ul><p>Hopefully that has helped illustrate how to actually use these methods in practice.</p><p>Next up, the <a href="/redux-toolkit/tutorials/advanced-tutorial">Advanced Tutorial</a> looks at how to use RTK in an app that does async data fetching and uses TypeScript.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/redux-toolkit/tutorials/basic-tutorial"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Basic Tutorial</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/redux-toolkit/tutorials/advanced-tutorial"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Advanced Tutorial ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#reviewing-the-redux-todos-example" class="table-of-contents__link">Reviewing the Redux Todos Example</a></li><li><a href="#initial-conversion-steps" class="table-of-contents__link">Initial Conversion Steps</a><ul><li><a href="#adding-redux-toolkit-to-the-project" class="table-of-contents__link">Adding Redux Toolkit to the Project</a></li><li><a href="#converting-the-store-to-use-configurestore" class="table-of-contents__link">Converting the Store to Use <code>configureStore</code></a></li></ul></li><li><a href="#creating-the-todos-slice" class="table-of-contents__link">Creating the Todos Slice</a><ul><li><a href="#understanding-slices" class="table-of-contents__link">Understanding Slices</a></li><li><a href="#examining-the-original-todos-reducer" class="table-of-contents__link">Examining the Original Todos Reducer</a></li><li><a href="#writing-the-slice-reducer" class="table-of-contents__link">Writing the Slice Reducer</a></li><li><a href="#updating-the-todos-tests" class="table-of-contents__link">Updating the Todos Tests</a></li><li><a href="#implementing-todo-ids" class="table-of-contents__link">Implementing Todo IDs</a></li></ul></li><li><a href="#using-the-new-todos-slice" class="table-of-contents__link">Using the New Todos Slice</a><ul><li><a href="#updating-the-root-reducer" class="table-of-contents__link">Updating the Root Reducer</a></li><li><a href="#updating-the-add-todo-component" class="table-of-contents__link">Updating the Add Todo Component</a></li><li><a href="#updating-the-todo-list" class="table-of-contents__link">Updating the Todo List</a></li></ul></li><li><a href="#creating-and-using-the-filters-slice" class="table-of-contents__link">Creating and Using the Filters Slice</a><ul><li><a href="#writing-the-filters-slice" class="table-of-contents__link">Writing the Filters Slice</a></li><li><a href="#using-the-filters-slice" class="table-of-contents__link">Using the Filters Slice</a></li></ul></li><li><a href="#optimizing-todo-filtering" class="table-of-contents__link">Optimizing Todo Filtering</a></li><li><a href="#cleanup" class="table-of-contents__link">Cleanup</a></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/redux-toolkit/introduction/quick-start">Come√ßo r√°pido</a></li><li class="footer__item"><a class="footer__link-item" href="/redux-toolkit/api/configureStore">Refer√™ncia de API</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Comunidade</h4><ul class="footer__items"><li class="footer__item"><a href="http://stackoverflow.com/questions/tagged/redux" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discord.gg/0ZcbPKXt5bZ6au5t" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Mais</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.github.com/reduxjs/redux-toolkit" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/img/global/badges/netlify-light.svg" alt="Deploys by Netlify">
                </a>
              </li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><img class="footer__logo" alt="Redux Logo" src="/redux-toolkit/img/redux_white.svg"></div><div>Direito autoral ¬© 2015‚Äì2021 Dan Abramov and the Redux documentation authors.</div></div></div></footer></div>
<script src="/redux-toolkit/styles.eb99357f.js"></script>
<script src="/redux-toolkit/runtime~main.68ebf52a.js"></script>
<script src="/redux-toolkit/main.3d9f7115.js"></script>
<script src="/redux-toolkit/1.57fadc6f.js"></script>
<script src="/redux-toolkit/2.2b7db848.js"></script>
<script src="/redux-toolkit/27.1911eaf1.js"></script>
<script src="/redux-toolkit/30.fc892cc4.js"></script>
<script src="/redux-toolkit/f976f453.bed7d5e1.js"></script>
<script src="/redux-toolkit/17896441.4d650456.js"></script>
<script src="/redux-toolkit/0fdf4150.821e68e8.js"></script>
</body>
</html>